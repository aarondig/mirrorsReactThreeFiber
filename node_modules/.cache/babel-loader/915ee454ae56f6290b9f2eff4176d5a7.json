{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _construct from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/construct.js\";\nimport _objectWithoutProperties from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _toConsumableArray from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _toArray from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport _slicedToArray from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nvar _excluded = [\"args\"],\n  _excluded2 = [\"args\"],\n  _excluded3 = [\"args\"],\n  _excluded4 = [\"filter\", \"computeOffsets\"],\n  _excluded5 = [\"ready\", \"manual\", \"vr\", \"noEvents\", \"invalidateFrameloop\", \"frames\", \"subscribers\", \"captured\", \"initialClick\", \"initialHits\"],\n  _excluded6 = [\"children\", \"setEvents\", \"container\", \"renderer\", \"effects\"],\n  _excluded7 = [\"renderer\", \"effects\", \"children\", \"vr\", \"webgl1\", \"concurrent\", \"shadowMap\", \"colorManagement\", \"orthographic\", \"invalidateFrameloop\", \"updateDefaultCamera\", \"noEvents\", \"gl\", \"camera\", \"raycaster\", \"pixelRatio\", \"onCreated\", \"onPointerMissed\", \"preRender\", \"resize\", \"style\"],\n  _excluded8 = [\"onGotPointerCaptureLegacy\"],\n  _excluded9 = [\"children\"];\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as THREE from 'three';\nimport { Layers, Color, Texture, sRGBEncoding, Vector2, Raycaster, Scene, OrthographicCamera, PerspectiveCamera, Clock, Vector3, PCFSoftShadowMap, ACESFilmicToneMapping, WebGL1Renderer, WebGLRenderer } from 'three';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport React, { createContext, useState, useRef, useCallback, useMemo, useLayoutEffect, useEffect, createElement, useContext as useContext$1 } from 'react';\nimport { TinyEmitter } from 'tiny-emitter';\nimport { useAsset } from 'use-asset';\nimport useMeasure from 'react-use-measure';\nimport mergeRefs from 'react-merge-refs';\nvar name = \"react-three-fiber\";\nvar version = \"5.3.22\";\nvar roots = new Map();\nvar emptyObject = {};\nvar is = {\n  obj: function obj(a) {\n    return a === Object(a) && !is.arr(a);\n  },\n  fun: function fun(a) {\n    return typeof a === 'function';\n  },\n  str: function str(a) {\n    return typeof a === 'string';\n  },\n  num: function num(a) {\n    return typeof a === 'number';\n  },\n  und: function und(a) {\n    return a === void 0;\n  },\n  arr: function arr(a) {\n    return Array.isArray(a);\n  },\n  equ: function equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    var i;\n    for (i in a) if (!(i in b)) return false;\n    for (i in b) if (a[i] !== b[i]) return false;\n    return is.und(i) ? a === b : true;\n  }\n};\nfunction createSubs(callback, subs) {\n  var index = subs.length;\n  subs.push(callback);\n  return function () {\n    return void subs.splice(index, 1);\n  };\n}\nvar globalEffects = [];\nvar globalAfterEffects = [];\nvar globalTailEffects = [];\nvar addEffect = function addEffect(callback) {\n  return createSubs(callback, globalEffects);\n};\nvar addAfterEffect = function addAfterEffect(callback) {\n  return createSubs(callback, globalAfterEffects);\n};\nvar addTail = function addTail(callback) {\n  return createSubs(callback, globalTailEffects);\n};\nfunction renderGl(state, timestamp) {\n  var repeat = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var runGlobalEffects = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  var i; // Run global effects\n\n  if (runGlobalEffects) {\n    for (i = 0; i < globalEffects.length; i++) {\n      globalEffects[i](timestamp);\n      repeat++;\n    }\n  } // Run local effects\n\n  var delta = state.current.clock.getDelta();\n  for (i = 0; i < state.current.subscribers.length; i++) {\n    state.current.subscribers[i].ref.current(state.current, delta);\n  } // Decrease frame count\n\n  state.current.frames = Math.max(0, state.current.frames - 1);\n  repeat += !state.current.invalidateFrameloop ? 1 : state.current.frames; // Render content\n\n  if (!state.current.manual && state.current.gl.render) state.current.gl.render(state.current.scene, state.current.camera); // Run global after-effects\n\n  if (runGlobalEffects) {\n    for (i = 0; i < globalAfterEffects.length; i++) {\n      globalAfterEffects[i](timestamp);\n    }\n  }\n  return repeat;\n}\nvar running = false;\nfunction renderLoop(timestamp) {\n  running = true;\n  var repeat = 0;\n  var i; // Run global effects\n\n  for (i = 0; i < globalEffects.length; i++) {\n    globalEffects[i](timestamp);\n    repeat++;\n  }\n  roots.forEach(function (root) {\n    var state = root.containerInfo.__state; // If the frameloop is invalidated, do not run another frame\n\n    if (state.current.active && state.current.ready && (!state.current.invalidateFrameloop || state.current.frames > 0)) {\n      repeat = renderGl(state, timestamp, repeat);\n    } else {\n      repeat = 0;\n    }\n  }); // Run global after-effects\n\n  for (i = 0; i < globalAfterEffects.length; i++) {\n    globalAfterEffects[i](timestamp);\n  }\n  if (repeat !== 0) {\n    return requestAnimationFrame(renderLoop);\n  } else {\n    // Tail call effects, they are called when rendering stops\n    for (i = 0; i < globalTailEffects.length; i++) {\n      globalTailEffects[i](timestamp);\n    }\n  } // Flag end of operation\n\n  running = false;\n}\nfunction _invalidate() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n  var frames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  if (state === true) {\n    roots.forEach(function (root) {\n      var state = root.containerInfo.__state;\n      state.current.frames = state.current.ready ? state.current.frames + frames : frames;\n    });\n  } else if (state && state.current) {\n    if (state.current.vr) return;\n    state.current.frames = state.current.ready ? state.current.frames + frames : frames;\n  }\n  if (!running) {\n    running = true;\n    requestAnimationFrame(renderLoop);\n  }\n}\nfunction forceResize() {\n  roots.forEach(function (root) {\n    return root.containerInfo.__state.current.forceResize();\n  });\n}\nvar catalogue = {};\nvar extend = function extend(objects) {\n  return void (catalogue = _objectSpread(_objectSpread({}, catalogue), objects));\n};\nfunction applyProps(instance, newProps) {\n  var oldProps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var accumulative = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  // Filter equals, events and reserved props\n  var container = instance.__container;\n  var sameProps = [];\n  var handlers = [];\n  var i;\n  var keys = Object.keys(newProps);\n  for (i = 0; i < keys.length; i++) {\n    if (is.equ(newProps[keys[i]], oldProps[keys[i]])) {\n      sameProps.push(keys[i]);\n    } // Event-handlers ...\n    //   are functions, that\n    //   start with \"on\", and\n    //   contain the name \"Pointer\", \"Click\", \"ContextMenu\", or \"Wheel\"\n\n    if (is.fun(newProps[keys[i]]) && keys[i].startsWith('on')) {\n      if (keys[i].includes('Pointer') || keys[i].includes('Click') || keys[i].includes('ContextMenu') || keys[i].includes('Wheel')) {\n        handlers.push(keys[i]);\n      }\n    }\n  }\n  var leftOvers = [];\n  keys = Object.keys(oldProps);\n  if (accumulative) {\n    for (i = 0; i < keys.length; i++) {\n      if (newProps[keys[i]] === void 0) {\n        leftOvers.push(keys[i]);\n      }\n    }\n  }\n  var toFilter = [].concat(sameProps, ['children', 'key', 'ref']); // Instances use \"object\" as a reserved identifier\n\n  if (instance.__instance) toFilter.push('object');\n  var filteredProps = _objectSpread({}, newProps); // Removes sameProps and reserved props from newProps\n\n  keys = Object.keys(filteredProps);\n  for (i = 0; i < keys.length; i++) {\n    if (toFilter.indexOf(keys[i]) > -1) {\n      delete filteredProps[keys[i]];\n    }\n  } // Add left-overs as undefined props so they can be removed\n\n  keys = Object.keys(leftOvers);\n  for (i = 0; i < keys.length; i++) {\n    if (keys[i] !== 'children') {\n      filteredProps[keys[i]] = undefined;\n    }\n  }\n  var filteredPropsEntries = Object.entries(filteredProps);\n  if (filteredPropsEntries.length > 0) {\n    filteredPropsEntries.forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n      if (!handlers.includes(key)) {\n        var _instance$__container, _instance$__container2;\n        var root = instance;\n        var target = root[key];\n        if (key.includes('-')) {\n          var entries = key.split('-');\n          target = entries.reduce(function (acc, key) {\n            return acc[key];\n          }, instance); // If the target is atomic, it forces us to switch the root\n\n          if (!(target && target.set)) {\n            var _entries$reverse = entries.reverse(),\n              _entries$reverse2 = _toArray(_entries$reverse),\n              _name = _entries$reverse2[0],\n              reverseEntries = _entries$reverse2.slice(1);\n            root = reverseEntries.reverse().reduce(function (acc, key) {\n              return acc[key];\n            }, instance);\n            key = _name;\n          }\n        } // Special treatment for objects with support for set/copy\n\n        var isColorManagement = (_instance$__container = instance.__container) == null ? void 0 : (_instance$__container2 = _instance$__container.__state) == null ? void 0 : _instance$__container2.current.colorManagement;\n        if (target && target.set && (target.copy || target instanceof Layers)) {\n          // If value is an array it has got to be the set function\n          if (Array.isArray(value)) {\n            var _target;\n            (_target = target).set.apply(_target, _toConsumableArray(value));\n          } // Test again target.copy(class) next ...\n          else if (target.copy && value && value.constructor && target.constructor.name === value.constructor.name) {\n            target.copy(value);\n          } // If nothing else fits, just set the single value, ignore undefined\n          // https://github.com/react-spring/react-three-fiber/issues/274\n          else if (value !== undefined) {\n            target.set(value); // Auto-convert sRGB colors, for now ...\n            // https://github.com/react-spring/react-three-fiber/issues/344\n\n            if (isColorManagement && target instanceof Color) {\n              target.convertSRGBToLinear();\n            }\n          } // Else, just overwrite the value\n        } else {\n          root[key] = value; // Auto-convert sRGB textures, for now ...\n          // https://github.com/react-spring/react-three-fiber/issues/344\n\n          if (isColorManagement && root[key] instanceof Texture) {\n            root[key].encoding = sRGBEncoding;\n          }\n        }\n        invalidateInstance(instance);\n      }\n    }); // Preemptively delete the instance from the containers interaction\n\n    if (accumulative && container && instance.raycast && instance.__handlers) {\n      instance.__handlers = undefined;\n      var index = container.__interaction.indexOf(instance);\n      if (index > -1) container.__interaction.splice(index, 1);\n    } // Prep interaction handlers\n\n    if (handlers.length) {\n      if (accumulative && container && instance.raycast) container.__interaction.push(instance); // Add handlers to the instances handler-map\n\n      instance.__handlers = handlers.reduce(function (acc, key) {\n        acc[key.charAt(2).toLowerCase() + key.substr(3)] = newProps[key];\n        return acc;\n      }, {});\n    } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n    if (instance.parent) updateInstance(instance);\n  }\n}\nfunction invalidateInstance(instance) {\n  if (instance.__container && instance.__container.__state) _invalidate(instance.__container.__state);\n}\nfunction updateInstance(instance) {\n  if (instance.onUpdate) instance.onUpdate(instance);\n}\nfunction createInstance(type, _ref3, container, hostContext, internalInstanceHandle) {\n  var _ref3$args = _ref3.args,\n    args = _ref3$args === void 0 ? [] : _ref3$args,\n    props = _objectWithoutProperties(_ref3, _excluded);\n  var name = \"\".concat(type[0].toUpperCase()).concat(type.slice(1));\n  var instance;\n  if (type === 'primitive') {\n    // Switch off dispose for primitive objects\n    props = _objectSpread({\n      dispose: null\n    }, props);\n    instance = props.object;\n    instance.__instance = true;\n    instance.__dispose = instance.dispose;\n  } else {\n    var target = catalogue[name] || THREE[name];\n    if (!target) {\n      throw \"\\\"\".concat(name, \"\\\" is not part of the THREE namespace! Did you forget to extend it? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively\");\n    }\n    instance = is.arr(args) ? _construct(target, _toConsumableArray(args)) : new target(args);\n  } // Bind to the root container in case portals are being used\n  // This is perhaps better for event management as we can keep them on a single instance\n\n  while (container.__container) {\n    container = container.__container;\n  } // TODO: https://github.com/facebook/react/issues/17147\n  // If it's still not there it means the portal was created on a virtual node outside of react\n\n  if (!roots.has(container)) {\n    var fn = function fn(node) {\n      if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n    };\n    container = fn(internalInstanceHandle);\n  } // Apply initial props\n\n  instance.__objects = [];\n  instance.__container = container; // Auto-attach geometries and materials\n\n  if (name.endsWith('Geometry')) {\n    props = _objectSpread({\n      attach: 'geometry'\n    }, props);\n  } else if (name.endsWith('Material')) {\n    props = _objectSpread({\n      attach: 'material'\n    }, props);\n  } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n  // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n  // why it passes \"true\" here\n\n  applyProps(instance, props, {});\n  return instance;\n}\nfunction appendChild(parentInstance, child) {\n  if (child) {\n    if (child.isObject3D) {\n      parentInstance.add(child);\n    } else {\n      parentInstance.__objects.push(child);\n      child.parent = parentInstance; // The attach attribute implies that the object attaches itself on the parent\n\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach) {\n        parentInstance[child.attach] = child;\n      }\n    }\n    updateInstance(child);\n    invalidateInstance(child);\n  }\n}\nfunction insertBefore(parentInstance, child, beforeChild) {\n  if (child) {\n    if (child.isObject3D) {\n      child.parent = parentInstance;\n      child.dispatchEvent({\n        type: 'added'\n      });\n      var restSiblings = parentInstance.children.filter(function (sibling) {\n        return sibling !== child;\n      }); // TODO: the order is out of whack if data objects are present, has to be recalculated\n\n      var index = restSiblings.indexOf(beforeChild);\n      parentInstance.children = [].concat(_toConsumableArray(restSiblings.slice(0, index)), [child], _toConsumableArray(restSiblings.slice(index)));\n      updateInstance(child);\n    } else {\n      appendChild(parentInstance, child);\n    } // TODO: order!!!\n\n    invalidateInstance(child);\n  }\n}\nfunction removeRecursive(array, parent) {\n  var clone = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  if (array) {\n    // Three uses splice op's internally we may have to shallow-clone the array in order to safely remove items\n    var target = clone ? _toConsumableArray(array) : array;\n    target.forEach(function (child) {\n      return removeChild(parent, child);\n    });\n  }\n}\nfunction removeChild(parentInstance, child) {\n  if (child) {\n    if (child.isObject3D) {\n      parentInstance.remove(child);\n    } else {\n      child.parent = null;\n      if (parentInstance.__objects) parentInstance.__objects = parentInstance.__objects.filter(function (x) {\n        return x !== child;\n      }); // Remove attachment\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(function (x) {\n          return x !== child;\n        });\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach) {\n        parentInstance[child.attach] = null;\n      }\n    } // Remove interactivity\n\n    if (child.__container) child.__container.__interaction = child.__container.__interaction.filter(function (x) {\n      return x !== child;\n    });\n    invalidateInstance(child); // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n\n    if (child.dispose !== null) {\n      unstable_runWithPriority(unstable_IdlePriority, function () {\n        // Remove nested child objects\n        removeRecursive(child.__objects, child);\n        removeRecursive(child.children, child, true); // Dispose item\n\n        if (child.dispose && child.type !== 'Scene') child.dispose();else if (child.__dispose) child.__dispose(); // Remove references\n\n        delete child.__container;\n        delete child.__objects;\n      });\n    }\n  }\n}\nfunction switchInstance(instance, type, newProps, fiber) {\n  var parent = instance.parent;\n  var newInstance = createInstance(type, newProps, instance.__container, null, fiber);\n  removeChild(parent, instance);\n  appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n  // https://github.com/facebook/react/issues/14983\n  // https://github.com/facebook/react/pull/15021\n  ;\n\n  [fiber, fiber.alternate].forEach(function (fiber) {\n    if (fiber !== null) {\n      fiber.stateNode = newInstance;\n      if (fiber.ref) {\n        if (is.fun(fiber.ref)) fiber.ref(newInstance);else fiber.ref.current = newInstance;\n      }\n    }\n  });\n}\nvar Renderer = Reconciler({\n  now: unstable_now,\n  createInstance: createInstance,\n  removeChild: removeChild,\n  appendChild: appendChild,\n  insertBefore: insertBefore,\n  warnsIfNotActing: true,\n  supportsMutation: true,\n  isPrimaryRenderer: false,\n  scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n  cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n  // @ts-ignore\n  setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n  // @ts-ignore\n  clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n  noTimeout: -1,\n  appendInitialChild: appendChild,\n  appendChildToContainer: appendChild,\n  removeChildFromContainer: removeChild,\n  insertInContainerBefore: insertBefore,\n  commitUpdate: function commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n    if (instance.__instance && newProps.object && newProps.object !== instance) {\n      // <instance object={...} /> where the object reference has changed\n      switchInstance(instance, type, newProps, fiber);\n    } else {\n      // This is a data object, let's extract critical information about it\n      var _newProps$args = newProps.args,\n        argsNew = _newProps$args === void 0 ? [] : _newProps$args,\n        restNew = _objectWithoutProperties(newProps, _excluded2);\n      var _oldProps$args = oldProps.args,\n        argsOld = _oldProps$args === void 0 ? [] : _oldProps$args,\n        restOld = _objectWithoutProperties(oldProps, _excluded3); // If it has new props or arguments, then it needs to be re-instanciated\n\n      var hasNewArgs = argsNew.some(function (value, index) {\n        return is.obj(value) ? Object.entries(value).some(function (_ref4) {\n          var _ref5 = _slicedToArray(_ref4, 2),\n            key = _ref5[0],\n            val = _ref5[1];\n          return val !== argsOld[index][key];\n        }) : value !== argsOld[index];\n      });\n      if (hasNewArgs) {\n        // Next we create a new instance and append it again\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // Otherwise just overwrite props\n        applyProps(instance, restNew, restOld, true);\n      }\n    }\n  },\n  hideInstance: function hideInstance(instance) {\n    if (instance.isObject3D) {\n      instance.visible = false;\n      invalidateInstance(instance);\n    }\n  },\n  unhideInstance: function unhideInstance(instance, props) {\n    if (instance.isObject3D && props.visible == null || props.visible) {\n      instance.visible = true;\n      invalidateInstance(instance);\n    }\n  },\n  hideTextInstance: function hideTextInstance() {\n    throw new Error('Text is not allowed in the react-three-fiber tree. You may have extraneous whitespace between components.');\n  },\n  getPublicInstance: function getPublicInstance(instance) {\n    return instance;\n  },\n  getRootHostContext: function getRootHostContext() {\n    return emptyObject;\n  },\n  getChildHostContext: function getChildHostContext() {\n    return emptyObject;\n  },\n  createTextInstance: function createTextInstance() {},\n  finalizeInitialChildren: function finalizeInitialChildren(instance) {\n    // https://github.com/facebook/react/issues/20271\n    // Returning true will trigger commitMount\n    return instance.__handlers;\n  },\n  commitMount: function commitMount(instance) /*, type, props*/\n  {\n    // https://github.com/facebook/react/issues/20271\n    // This will make sure events are only added once to the central container\n    var container = instance.__container;\n    if (container && instance.raycast && instance.__handlers) container.__interaction.push(instance);\n  },\n  prepareUpdate: function prepareUpdate() {\n    return emptyObject;\n  },\n  shouldDeprioritizeSubtree: function shouldDeprioritizeSubtree() {\n    return false;\n  },\n  prepareForCommit: function prepareForCommit() {\n    return null;\n  },\n  preparePortalMount: function preparePortalMount() {\n    return null;\n  },\n  resetAfterCommit: function resetAfterCommit() {},\n  shouldSetTextContent: function shouldSetTextContent() {\n    return false;\n  },\n  clearContainer: function clearContainer() {\n    return false;\n  }\n});\nvar hasSymbol = is.fun(Symbol) && Symbol.for;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nfunction render(element, container, state) {\n  var root = roots.get(container);\n  if (!root) {\n    container.__state = state; // @ts-ignore\n\n    var newRoot = root = Renderer.createContainer(container, state !== undefined && state.current.concurrent ? 2 : 0, false,\n    // @ts-ignore\n    null);\n    roots.set(container, newRoot);\n  }\n  Renderer.updateContainer(element, root, null, function () {\n    return undefined;\n  });\n  return Renderer.getPublicRootInstance(root);\n}\nfunction unmountComponentAtNode(container, callback) {\n  var root = roots.get(container);\n  if (root) {\n    Renderer.updateContainer(null, root, null, function () {\n      roots.delete(container);\n      if (callback) callback(container);\n    });\n  }\n}\nfunction createPortal(children, containerInfo, implementation) {\n  var key = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  if (!containerInfo.__objects) containerInfo.__objects = [];\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children: children,\n    containerInfo: containerInfo,\n    implementation: implementation\n  };\n}\nRenderer.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  //@ts-ignore\n  findHostInstanceByFiber: function findHostInstanceByFiber() {\n    return null;\n  },\n  version: version,\n  rendererPackageName: name\n});\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\nfunction isOrthographicCamera(def) {\n  return def.isOrthographicCamera;\n}\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\nvar stateContext = /*#__PURE__*/createContext({});\nvar useCanvas = function useCanvas(props) {\n  var children = props.children,\n    gl = props.gl,\n    camera = props.camera,\n    orthographic = props.orthographic,\n    raycaster = props.raycaster,\n    size = props.size,\n    pixelRatio = props.pixelRatio,\n    _props$vr = props.vr,\n    vr = _props$vr === void 0 ? false : _props$vr,\n    _props$concurrent = props.concurrent,\n    concurrent = _props$concurrent === void 0 ? false : _props$concurrent,\n    _props$shadowMap = props.shadowMap,\n    shadowMap = _props$shadowMap === void 0 ? false : _props$shadowMap,\n    _props$colorManagemen = props.colorManagement,\n    colorManagement = _props$colorManagemen === void 0 ? true : _props$colorManagemen,\n    _props$invalidateFram = props.invalidateFrameloop,\n    invalidateFrameloop = _props$invalidateFram === void 0 ? false : _props$invalidateFram,\n    _props$updateDefaultC = props.updateDefaultCamera,\n    updateDefaultCamera = _props$updateDefaultC === void 0 ? true : _props$updateDefaultC,\n    _props$noEvents = props.noEvents,\n    noEvents = _props$noEvents === void 0 ? false : _props$noEvents,\n    onCreated = props.onCreated,\n    onPointerMissed = props.onPointerMissed,\n    forceResize = props.forceResize; // Local, reactive state\n\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    ready = _useState2[0],\n    setReady = _useState2[1];\n  var _useState3 = useState(function () {\n      return new Vector2();\n    }),\n    _useState4 = _slicedToArray(_useState3, 1),\n    mouse = _useState4[0];\n  var _useState5 = useState(function () {\n      var ray = new Raycaster();\n      if (raycaster) {\n        var filter = raycaster.filter,\n          computeOffsets = raycaster.computeOffsets,\n          raycasterProps = _objectWithoutProperties(raycaster, _excluded4);\n        applyProps(ray, raycasterProps, {});\n      }\n      return ray;\n    }),\n    _useState6 = _slicedToArray(_useState5, 1),\n    defaultRaycaster = _useState6[0];\n  var _useState7 = useState(function () {\n      var scene = new Scene();\n      scene.__interaction = [];\n      scene.__objects = [];\n      return scene;\n    }),\n    _useState8 = _slicedToArray(_useState7, 1),\n    defaultScene = _useState8[0];\n  var _useState9 = useState(function () {\n      var cam = orthographic ? new OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new PerspectiveCamera(75, 0, 0.1, 1000);\n      cam.position.z = 5;\n      if (camera) applyProps(cam, camera, {}); // Always look at [0, 0, 0]\n\n      cam.lookAt(0, 0, 0);\n      return cam;\n    }),\n    _useState10 = _slicedToArray(_useState9, 2),\n    defaultCam = _useState10[0],\n    _setDefaultCamera = _useState10[1];\n  var _useState11 = useState(function () {\n      return new Clock();\n    }),\n    _useState12 = _slicedToArray(_useState11, 1),\n    clock = _useState12[0]; // Public state\n\n  var state = useRef({\n    ready: false,\n    active: true,\n    manual: 0,\n    colorManagement: colorManagement,\n    vr: vr,\n    concurrent: concurrent,\n    noEvents: noEvents,\n    invalidateFrameloop: false,\n    frames: 0,\n    aspect: 0,\n    subscribers: [],\n    camera: defaultCam,\n    scene: defaultScene,\n    raycaster: defaultRaycaster,\n    mouse: mouse,\n    clock: clock,\n    gl: gl,\n    size: size,\n    viewport: null,\n    initialClick: [0, 0],\n    initialHits: [],\n    pointer: new TinyEmitter(),\n    captured: undefined,\n    events: undefined,\n    subscribe: function subscribe(ref) {\n      var priority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      // If this subscription was given a priority, it takes rendering into its own hands\n      // For that reason we switch off automatic rendering and increase the manual flag\n      // As long as this flag is positive (there could be multiple render subscription)\n      // ..there can be no internal rendering at all\n      if (priority) state.current.manual++;\n      state.current.subscribers.push({\n        ref: ref,\n        priority: priority\n      }); // Sort layers from lowest to highest, meaning, highest priority renders last (on top of the other frames)\n\n      state.current.subscribers = state.current.subscribers.sort(function (a, b) {\n        return a.priority - b.priority;\n      });\n      return function () {\n        var _state$current;\n        if ((_state$current = state.current) == null ? void 0 : _state$current.subscribers) {\n          // Decrease manual flag if this subscription had a priority\n          if (priority) state.current.manual--;\n          state.current.subscribers = state.current.subscribers.filter(function (s) {\n            return s.ref !== ref;\n          });\n        }\n      };\n    },\n    setDefaultCamera: function setDefaultCamera(camera) {\n      return _setDefaultCamera(camera);\n    },\n    invalidate: function invalidate() {\n      return _invalidate(state);\n    },\n    intersect: function intersect() {\n      var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var prepare = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      return handlePointerMove(event, prepare);\n    },\n    forceResize: forceResize\n  });\n  var position = new Vector3();\n  var getCurrentViewport = useCallback(function () {\n    var camera = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : state.current.camera;\n    var target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Vector3(0, 0, 0);\n    var _state$current$size = state.current.size,\n      width = _state$current$size.width,\n      height = _state$current$size.height;\n    var distance = camera.getWorldPosition(position).distanceTo(target);\n    if (isOrthographicCamera(camera)) {\n      return {\n        width: width / camera.zoom,\n        height: height / camera.zoom,\n        factor: 1,\n        distance: distance\n      };\n    } else {\n      var fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n      var h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n      var w = h * (width / height);\n      return {\n        width: w,\n        height: h,\n        factor: width / w,\n        distance: distance\n      };\n    }\n  }, []); // Writes locals into public state for distribution among subscribers, context, etc\n\n  useMemo(function () {\n    state.current.ready = ready;\n    state.current.size = size;\n    state.current.camera = defaultCam;\n    state.current.invalidateFrameloop = invalidateFrameloop;\n    state.current.vr = vr;\n    state.current.gl = gl;\n    state.current.concurrent = concurrent;\n    state.current.noEvents = noEvents; // Make viewport backwards compatible\n\n    state.current.viewport = getCurrentViewport; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [invalidateFrameloop, vr, concurrent, noEvents, ready, size, defaultCam, gl]); // Adjusts default camera\n\n  useMemo(function () {\n    state.current.aspect = size.width / size.height; // Assign viewport props to the function\n\n    Object.assign(state.current.viewport, getCurrentViewport()); // https://github.com/drcmda/react-three-fiber/issues/92\n    // Sometimes automatic default camera adjustment isn't wanted behaviour\n\n    if (updateDefaultCamera) {\n      if (isOrthographicCamera(defaultCam)) {\n        defaultCam.left = size.width / -2;\n        defaultCam.right = size.width / 2;\n        defaultCam.top = size.height / 2;\n        defaultCam.bottom = size.height / -2;\n      } else {\n        defaultCam.aspect = state.current.aspect;\n      }\n      defaultCam.updateProjectionMatrix(); // https://github.com/react-spring/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      defaultCam.updateMatrixWorld();\n    }\n    gl.setSize(size.width, size.height);\n    if (ready) _invalidate(state); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultCam, gl, size, updateDefaultCamera, ready]); // Only trigger the context provider when necessary\n\n  var sharedState = useRef(null);\n  useMemo(function () {\n    var _state$current2 = state.current,\n      ready = _state$current2.ready,\n      manual = _state$current2.manual,\n      vr = _state$current2.vr,\n      noEvents = _state$current2.noEvents,\n      invalidateFrameloop = _state$current2.invalidateFrameloop,\n      frames = _state$current2.frames,\n      subscribers = _state$current2.subscribers,\n      captured = _state$current2.captured,\n      initialClick = _state$current2.initialClick,\n      initialHits = _state$current2.initialHits,\n      props = _objectWithoutProperties(_state$current2, _excluded5);\n    sharedState.current = props; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [size, defaultCam]); // Update pixel ratio\n\n  useLayoutEffect(function () {\n    if (pixelRatio) {\n      if (Array.isArray(pixelRatio)) gl.setPixelRatio(Math.max(Math.min(pixelRatio[0], window.devicePixelRatio), pixelRatio[1]));else gl.setPixelRatio(pixelRatio);\n    }\n  }, [gl, pixelRatio]); // Update shadow map\n\n  useLayoutEffect(function () {\n    if (shadowMap) {\n      gl.shadowMap.enabled = true;\n      if (typeof shadowMap === 'object') Object.assign(gl.shadowMap, shadowMap);else gl.shadowMap.type = PCFSoftShadowMap;\n    }\n    if (colorManagement) {\n      gl.toneMapping = ACESFilmicToneMapping;\n      gl.outputEncoding = sRGBEncoding;\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shadowMap, colorManagement]);\n  /** Events ------------------------------------------------------------------------------------------------ */\n\n  var hovered = useMemo(function () {\n    return new Map();\n  }, []);\n  var temp = new Vector3();\n  /** Sets up defaultRaycaster */\n\n  var prepareRay = useCallback(function (event) {\n    // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n    var offsets = (raycaster == null ? void 0 : raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, sharedState.current)) || event.nativeEvent;\n    if (offsets) {\n      var offsetX = offsets.offsetX,\n        offsetY = offsets.offsetY;\n      var _state$current$size2 = state.current.size,\n        width = _state$current$size2.width,\n        height = _state$current$size2.height;\n      mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n      defaultRaycaster.setFromCamera(mouse, state.current.camera);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  /** Intersects interaction objects using the event input */\n\n  var intersect = useCallback(function (filter) {\n    // Skip event handling when noEvents is set\n    if (state.current.noEvents) return [];\n    var seen = new Set();\n    var hits = []; // Allow callers to eliminate event objects\n\n    var eventsObjects = filter ? filter(state.current.scene.__interaction) : state.current.scene.__interaction; // Intersect known handler objects and filter against duplicates\n\n    var intersects = defaultRaycaster.intersectObjects(eventsObjects, true).filter(function (item) {\n      var id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster && raycaster.filter && sharedState.current) {\n      intersects = raycaster.filter(intersects, sharedState.current);\n    }\n    var _iterator = _createForOfIteratorHelper(intersects),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _intersect = _step.value;\n        var eventObject = _intersect.object; // Bubble event up\n\n        while (eventObject) {\n          var handlers = eventObject.__handlers;\n          if (handlers) hits.push(_objectSpread(_objectSpread({}, _intersect), {}, {\n            eventObject: eventObject\n          }));\n          eventObject = eventObject.parent;\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    return hits;\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  /**  Calculates click deltas */\n\n  var calculateDistance = useCallback(function (event) {\n    var dx = event.nativeEvent.offsetX - state.current.initialClick[0];\n    var dy = event.nativeEvent.offsetY - state.current.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }, []);\n  var handlePointerCancel = useCallback(function (event, hits) {\n    var prepare = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    state.current.pointer.emit('pointerCancel', event);\n    if (prepare) prepareRay(event);\n    Array.from(hovered.values()).forEach(function (hoveredObj) {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (hits && (!hits.length || !hits.find(function (hit) {\n        return hit.object === hoveredObj.object && hit.index === hoveredObj.index;\n      }))) {\n        var eventObject = hoveredObj.eventObject;\n        var handlers = eventObject.__handlers;\n        hovered.delete(makeId(hoveredObj));\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          var data = _objectSpread(_objectSpread({}, hoveredObj), {}, {\n            intersections: hits || []\n          });\n          if (handlers.pointerOut) handlers.pointerOut(_objectSpread(_objectSpread({}, data), {}, {\n            type: 'pointerout'\n          }));\n          if (handlers.pointerLeave) handlers.pointerLeave(_objectSpread(_objectSpread({}, data), {}, {\n            type: 'pointerleave'\n          }));\n        }\n      }\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n  var getIntersects = useCallback(function (event, filter) {\n    // Get fresh intersects\n    var intersections = intersect(filter); // If the interaction is captured take that into account, the captured event has to be part of the intersects\n\n    if (state.current.captured && event.type && event.type !== 'click' && event.type !== 'wheel') {\n      state.current.captured.forEach(function (captured) {\n        if (!intersections.find(function (hit) {\n          return hit.eventObject === captured.eventObject;\n        })) intersections.push(captured);\n      });\n    }\n    return intersections;\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  /**  Handles intersections by forwarding them to handlers */\n\n  var handleIntersects = useCallback(function (intersections, event, fn) {\n    // If anything has been found, forward it to the event listeners\n    if (intersections.length) {\n      var unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(state.current.camera);\n      var delta = event.type === 'click' ? calculateDistance(event) : 0;\n      var releasePointerCapture = function releasePointerCapture(id) {\n        return event.target.releasePointerCapture(id);\n      };\n      var localState = {\n        stopped: false,\n        captured: false\n      };\n      var _iterator2 = _createForOfIteratorHelper(intersections),\n        _step2;\n      try {\n        var _loop = function _loop() {\n          var hit = _step2.value;\n          var setPointerCapture = function setPointerCapture(id) {\n            // If the hit is going to be captured flag that we're in captured state\n            if (!localState.captured) {\n              localState.captured = true; // The captured hit array is reset to collect hits\n\n              state.current.captured = [];\n            } // Push hits to the array\n\n            if (state.current.captured) {\n              state.current.captured.push(hit);\n            } // Call the original event now\n            event.target.setPointerCapture(id);\n          };\n          var raycastEvent = _objectSpread(_objectSpread(_objectSpread({}, event), hit), {}, {\n            intersections: intersections,\n            stopped: localState.stopped,\n            delta: delta,\n            unprojectedPoint: unprojectedPoint,\n            ray: defaultRaycaster.ray,\n            camera: state.current.camera,\n            // Hijack stopPropagation, which just sets a flag\n            stopPropagation: function stopPropagation() {\n              // https://github.com/react-spring/react-three-fiber/issues/596\n              // Events are not allowed to stop propagation if the pointer has been captured\n              var cap = state.current.captured;\n              if (!cap || cap.find(function (h) {\n                return h.eventObject.id === hit.eventObject.id;\n              })) {\n                raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n                // An event handler is only allowed to flush other handlers if it is hovered itself\n\n                if (hovered.size && Array.from(hovered.values()).find(function (i) {\n                  return i.eventObject === hit.eventObject;\n                })) {\n                  // Objects cannot flush out higher up objects that have already caught the event\n                  var higher = intersections.slice(0, intersections.indexOf(hit));\n                  handlePointerCancel(raycastEvent, [].concat(_toConsumableArray(higher), [hit]));\n                }\n              }\n            },\n            target: _objectSpread(_objectSpread({}, event.target), {}, {\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            }),\n            currentTarget: _objectSpread(_objectSpread({}, event.currentTarget), {}, {\n              setPointerCapture: setPointerCapture,\n              releasePointerCapture: releasePointerCapture\n            }),\n            sourceEvent: event\n          });\n          fn(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n          if (localState.stopped === true) return 1; // break\n        };\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          if (_loop()) break;\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n    return intersections;\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  var handlePointerMove = useCallback(function (event) {\n    var prepare = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    state.current.pointer.emit('pointerMove', event);\n    if (prepare) prepareRay(event);\n    var hits = getIntersects(event,\n    // This is onPointerMove, we're only interested in events that exhibit this particular event\n    function (objects) {\n      return objects.filter(function (obj) {\n        return ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(function (name) {\n          return obj.__handlers['pointer' + name];\n        });\n      });\n    }); // Take care of unhover\n\n    handlePointerCancel(event, hits);\n    handleIntersects(hits, event, function (data) {\n      var eventObject = data.eventObject;\n      var handlers = eventObject.__handlers; // Check presence of handlers\n\n      if (!handlers) return; // Check if mouse enter or out is present\n\n      if (handlers.pointerOver || handlers.pointerEnter || handlers.pointerOut || handlers.pointerLeave) {\n        var id = makeId(data);\n        var hoveredItem = hovered.get(id);\n        if (!hoveredItem) {\n          // If the object wasn't previously hovered, book it and call its handler\n          hovered.set(id, data);\n          if (handlers.pointerOver) handlers.pointerOver(_objectSpread(_objectSpread({}, data), {}, {\n            type: 'pointerover'\n          }));\n          if (handlers.pointerEnter) handlers.pointerEnter(_objectSpread(_objectSpread({}, data), {}, {\n            type: 'pointerenter'\n          }));\n        } else if (hoveredItem.stopped) {\n          // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n          data.stopPropagation();\n        }\n      } // Call mouse move\n\n      if (handlers.pointerMove) handlers.pointerMove(data);\n    });\n    return hits; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var handlePointer = useCallback(function (name) {\n    return function (event) {\n      var prepare = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      state.current.pointer.emit(name, event);\n      if (prepare) prepareRay(event);\n      var hits = getIntersects(event);\n      handleIntersects(hits, event, function (data) {\n        var eventObject = data.eventObject;\n        var handlers = eventObject.__handlers;\n        if (handlers && handlers[name]) {\n          // Forward all events back to their respective handlers with the exception of click events,\n          // which must use the initial target\n          if (name !== 'click' && name !== 'contextMenu' && name !== 'doubleClick' || state.current.initialHits.includes(eventObject)) {\n            handlers[name](data);\n            pointerMissed(event, defaultScene.__interaction, function (object) {\n              return object !== eventObject;\n            });\n          }\n        }\n      }); // If a click yields no results, pass it back to the user as a miss\n\n      if (name === 'pointerDown') {\n        state.current.initialClick = [event.nativeEvent.offsetX, event.nativeEvent.offsetY];\n        state.current.initialHits = hits.map(function (hit) {\n          return hit.eventObject;\n        });\n      }\n      if ((name === 'click' || name === 'contextMenu' || name === 'doubleClick') && !hits.length) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, defaultScene.__interaction);\n          if (onPointerMissed) onPointerMissed();\n        }\n      }\n    };\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [onPointerMissed, calculateDistance, getIntersects, handleIntersects, prepareRay]);\n  useMemo(function () {\n    state.current.events = {\n      onClick: handlePointer('click'),\n      onContextMenu: handlePointer('contextMenu'),\n      onDoubleClick: handlePointer('doubleClick'),\n      onWheel: handlePointer('wheel'),\n      onPointerDown: handlePointer('pointerDown'),\n      onPointerUp: handlePointer('pointerUp'),\n      onPointerLeave: function onPointerLeave(e) {\n        return handlePointerCancel(e, []);\n      },\n      onPointerMove: handlePointerMove,\n      // onGotPointerCapture is not needed any longer because the behaviour is hacked into\n      // the event itself (see handleIntersects). But in order for non-web targets to simulate\n      // it we keep the legacy event, which simply flags all current intersects as captured\n      onGotPointerCaptureLegacy: function onGotPointerCaptureLegacy(e) {\n        return state.current.captured = intersect();\n      },\n      onLostPointerCapture: function onLostPointerCapture(e) {\n        return state.current.captured = undefined, handlePointerCancel(e);\n      }\n    };\n  }, [handlePointer, intersect, handlePointerCancel, handlePointerMove]);\n  /** Events ------------------------------------------------------------------------------------------------- */\n  // This component is a bridge into the three render context, when it gets rendered\n  // we know we are ready to compile shaders, call subscribers, etc\n\n  var Canvas = useCallback(function Canvas(props) {\n    var activate = function activate() {\n      return setReady(true);\n    }; // Pre-compile all materials before rendering out the first time\n\n    useLayoutEffect(function () {\n      return void gl.compile(defaultScene, defaultCam);\n    }, []);\n    useEffect(function () {\n      var result = onCreated && onCreated(state.current);\n      if (result && result.then) result.then(activate);else activate();\n    }, []);\n    return props.children;\n  },\n  // The Canvas component has to be static, it should not be re-created ever\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []); // Render v-dom into scene\n\n  useLayoutEffect(function () {\n    render( /*#__PURE__*/createElement(Canvas, null, /*#__PURE__*/createElement(stateContext.Provider, {\n      value: sharedState.current\n    }, typeof children === 'function' ? children(state.current) : children)), defaultScene, state); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ready, children, sharedState.current]);\n  useLayoutEffect(function () {\n    if (ready) {\n      // Start render-loop, either via RAF or setAnimationLoop for VR\n      if (!state.current.vr) {\n        if (state.current.frames === 0) _invalidate(state);\n      } else if ((gl.xr || gl.vr) && gl.setAnimationLoop) {\n        (gl.xr || gl.vr).enabled = true;\n        gl.setAnimationLoop(function (t) {\n          return renderGl(state, t, 0, true);\n        });\n      } else {\n        console.warn('the gl instance does not support VR!');\n      }\n    }\n  }, [gl, ready, invalidateFrameloop]); // Dispose renderer on unmount\n\n  useEffect(function () {\n    return function () {\n      if (state.current.gl) {\n        if (state.current.gl.renderLists) state.current.gl.renderLists.dispose();\n        if (state.current.gl.forceContextLoss) state.current.gl.forceContextLoss();\n        dispose(state.current.gl);\n      }\n      unmountComponentAtNode(state.current.scene, function () {\n        dispose(state.current.raycaster);\n        dispose(state.current.camera);\n        dispose(state.current);\n      });\n    };\n  }, []);\n  return state.current.events;\n};\nfunction pointerMissed(event, objects) {\n  var filter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (object) {\n    return true;\n  };\n  objects.filter(filter).forEach(function (object) {\n    var _handlers$pointerMis, _handlers;\n    return (_handlers$pointerMis = (_handlers = object.__handlers).pointerMissed) == null ? void 0 : _handlers$pointerMis.call(_handlers, event);\n  });\n}\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n  for (var p in obj) {\n    if (typeof p === 'object' && p.dispose) p.dispose();\n    delete obj[p];\n  }\n}\nfunction useContext(context) {\n  var result = useContext$1(context);\n  if (!('subscribe' in result)) {\n    throw new Error(\"\\u26A1\\uFE0F react-three-fiber hooks can only be used within the Canvas component! https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#hooks\");\n  }\n  return result;\n}\nfunction useFrame(callback) {\n  var renderPriority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var _useContext = useContext(stateContext),\n    subscribe = _useContext.subscribe; // Update ref\n\n  var ref = useRef(callback);\n  useLayoutEffect(function () {\n    return void (ref.current = callback);\n  }, [callback]); // Subscribe/unsub\n\n  useEffect(function () {\n    var unsubscribe = subscribe(ref, renderPriority);\n    return function () {\n      return unsubscribe();\n    };\n  }, [renderPriority, subscribe]);\n  return null;\n}\nfunction useThree() {\n  return useContext(stateContext);\n}\nfunction useUpdate(callback, dependents, optionalRef) {\n  var _useContext2 = useContext(stateContext),\n    invalidate = _useContext2.invalidate;\n  var localRef = useRef();\n  var ref = optionalRef ? optionalRef : localRef;\n  useLayoutEffect(function () {\n    if (ref.current) {\n      callback(ref.current);\n      invalidate();\n    }\n  }, dependents); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return ref;\n}\nfunction useResource(optionalRef) {\n  var _useState13 = useState(false),\n    _useState14 = _slicedToArray(_useState13, 2),\n    _ = _useState14[0],\n    forceUpdate = _useState14[1];\n  var localRef = useRef(undefined);\n  var ref = optionalRef ? optionalRef : localRef;\n  useLayoutEffect(function () {\n    return void forceUpdate(function (i) {\n      return !i;\n    });\n  }, []);\n  return ref;\n}\nfunction buildGraph(object) {\n  var data = {\n    nodes: {},\n    materials: {}\n  };\n  if (object) {\n    object.traverse(function (obj) {\n      if (obj.name) data.nodes[obj.name] = obj;\n      if (obj.material && !data.materials[obj.material.name]) data.materials[obj.material.name] = obj.material;\n    });\n  }\n  return data;\n}\nfunction useGraph(object) {\n  return useMemo(function () {\n    return buildGraph(object);\n  }, [object]);\n}\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto) {\n    // Construct new loader and run extensions\n    var loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n    for (var _len = arguments.length, input = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      input[_key - 1] = arguments[_key];\n    }\n    return Promise.all(input.map(function (input) {\n      return new Promise(function (res, reject) {\n        return loader.load(input, function (data) {\n          if (data.scene) Object.assign(data, buildGraph(data.scene));\n          res(data);\n        }, onProgress, function (error) {\n          var _error$message;\n          return reject((_error$message = error.message) != null ? _error$message : \"failure loading \".concat(input));\n        });\n      });\n    }));\n  };\n}\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  var keys = Array.isArray(input) ? input : [input];\n  var results = useAsset.apply(void 0, [loadingFn(extensions, onProgress), Proto].concat(_toConsumableArray(keys))); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\nuseLoader.preload = function (Proto, input, extensions) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload.apply(useAsset, [loadingFn(extensions), Proto].concat(_toConsumableArray(keys)));\n};\nvar defaultStyles = {\n  position: 'relative',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\nfunction Content(_ref6) {\n  var children = _ref6.children,\n    setEvents = _ref6.setEvents,\n    container = _ref6.container,\n    renderer = _ref6.renderer,\n    effects = _ref6.effects,\n    props = _objectWithoutProperties(_ref6, _excluded6);\n  // Create renderer\n  var _useState15 = useState(renderer),\n    _useState16 = _slicedToArray(_useState15, 1),\n    gl = _useState16[0];\n  if (!gl) console.warn('No renderer created!'); // Mount and unmount management\n\n  useEffect(function () {\n    if (effects) effects(gl, container);\n  }, [container, effects, gl]); // Init canvas, fetch events, hand them back to the wrapping div\n\n  var events = useCanvas(_objectSpread(_objectSpread({}, props), {}, {\n    children: children,\n    gl: gl\n  }));\n  useEffect(function () {\n    setEvents(events);\n  }, [events, setEvents]);\n  return null;\n}\nvar ResizeContainer = /*#__PURE__*/React.memo(function ResizeContainer(props) {\n  var renderer = props.renderer,\n    effects = props.effects,\n    children = props.children,\n    vr = props.vr,\n    webgl1 = props.webgl1,\n    concurrent = props.concurrent,\n    shadowMap = props.shadowMap,\n    colorManagement = props.colorManagement,\n    orthographic = props.orthographic,\n    invalidateFrameloop = props.invalidateFrameloop,\n    updateDefaultCamera = props.updateDefaultCamera,\n    noEvents = props.noEvents,\n    gl = props.gl,\n    camera = props.camera,\n    raycaster = props.raycaster,\n    pixelRatio = props.pixelRatio,\n    onCreated = props.onCreated,\n    onPointerMissed = props.onPointerMissed,\n    preRender = props.preRender,\n    resize = props.resize,\n    style = props.style,\n    restSpread = _objectWithoutProperties(props, _excluded7);\n  var containerRef = useRef(); // onGotPointerCaptureLegacy is a fake event used by non-web targets to simulate poinzter capture\n\n  var _useState17 = useState({}),\n    _useState18 = _slicedToArray(_useState17, 2),\n    _useState18$ = _useState18[0],\n    onGotPointerCaptureLegacy = _useState18$.onGotPointerCaptureLegacy,\n    events = _objectWithoutProperties(_useState18$, _excluded8),\n    setEvents = _useState18[1];\n  var _useMeasure = useMeasure(_objectSpread({\n      scroll: true,\n      debounce: {\n        scroll: 50,\n        resize: 0\n      }\n    }, resize)),\n    _useMeasure2 = _slicedToArray(_useMeasure, 3),\n    bind = _useMeasure2[0],\n    size = _useMeasure2[1],\n    forceResize = _useMeasure2[2]; // Flag view ready once it's been measured out\n\n  var readyFlag = useRef(false);\n  var ready = useMemo(function () {\n    return readyFlag.current = readyFlag.current || !!size.width && !!size.height;\n  }, [size]);\n  var state = useMemo(function () {\n    return {\n      size: size,\n      forceResize: forceResize,\n      setEvents: setEvents,\n      container: containerRef.current\n    };\n  }, [forceResize, size]); // Allow Gatsby, Next and other server side apps to run. Will output styles to reduce flickering.\n\n  if (typeof window === 'undefined') return /*#__PURE__*/React.createElement(\"div\", _extends({\n    style: _objectSpread(_objectSpread({}, defaultStyles), style)\n  }, restSpread), preRender); // Render the canvas into the dom\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: mergeRefs([bind, containerRef]),\n    style: _objectSpread(_objectSpread({}, defaultStyles), style)\n  }, events, restSpread), preRender, ready && /*#__PURE__*/React.createElement(Content, _extends({}, props, state)));\n});\nvar Canvas = /*#__PURE__*/React.memo(function Canvas(_ref7) {\n  var children = _ref7.children,\n    props = _objectWithoutProperties(_ref7, _excluded9);\n  var canvasRef = useRef();\n  var _renderer = props.webgl1 ? WebGL1Renderer : WebGLRenderer;\n  return /*#__PURE__*/React.createElement(ResizeContainer, _extends({}, props, {\n    renderer: function renderer() {\n      if (canvasRef.current) {\n        var params = _objectSpread({\n          antialias: true,\n          alpha: true\n        }, props.gl);\n        var temp = new _renderer(_objectSpread({\n          powerPreference: 'high-performance',\n          //stencil: false,\n          //depth: false,\n          canvas: canvasRef.current\n        }, params));\n        return temp;\n      }\n    },\n    preRender: /*#__PURE__*/React.createElement(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        display: 'block'\n      }\n    })\n  }), children);\n});\nexport { Canvas, threeTypes as ReactThreeFiber, Renderer, ResizeContainer, addAfterEffect, addEffect, addTail, applyProps, createPortal, extend, forceResize, _invalidate as invalidate, isOrthographicCamera, render, renderGl, stateContext, unmountComponentAtNode, useCanvas, useFrame, useGraph, useLoader, useResource, useThree, useUpdate };","map":{"version":3,"names":["_extends","THREE","Layers","Color","Texture","sRGBEncoding","Vector2","Raycaster","Scene","OrthographicCamera","PerspectiveCamera","Clock","Vector3","PCFSoftShadowMap","ACESFilmicToneMapping","WebGL1Renderer","WebGLRenderer","Reconciler","unstable_now","unstable_runWithPriority","unstable_IdlePriority","React","createContext","useState","useRef","useCallback","useMemo","useLayoutEffect","useEffect","createElement","useContext","useContext$1","TinyEmitter","useAsset","useMeasure","mergeRefs","name","version","roots","Map","emptyObject","is","obj","a","Object","arr","fun","str","num","und","Array","isArray","equ","b","i","createSubs","callback","subs","index","length","push","splice","globalEffects","globalAfterEffects","globalTailEffects","addEffect","addAfterEffect","addTail","renderGl","state","timestamp","repeat","arguments","undefined","runGlobalEffects","delta","current","clock","getDelta","subscribers","ref","frames","Math","max","invalidateFrameloop","manual","gl","render","scene","camera","running","renderLoop","forEach","root","containerInfo","__state","active","ready","requestAnimationFrame","invalidate","vr","forceResize","catalogue","extend","objects","_objectSpread","applyProps","instance","newProps","oldProps","accumulative","container","__container","sameProps","handlers","keys","startsWith","includes","leftOvers","toFilter","concat","__instance","filteredProps","indexOf","filteredPropsEntries","entries","_ref","_ref2","_slicedToArray","key","value","_instance$__container","_instance$__container2","target","split","reduce","acc","set","_entries$reverse","reverse","_entries$reverse2","_toArray","reverseEntries","slice","isColorManagement","colorManagement","copy","_target","apply","_toConsumableArray","constructor","convertSRGBToLinear","encoding","invalidateInstance","raycast","__handlers","__interaction","charAt","toLowerCase","substr","parent","updateInstance","onUpdate","createInstance","type","_ref3","hostContext","internalInstanceHandle","_ref3$args","args","props","_objectWithoutProperties","_excluded","toUpperCase","dispose","object","__dispose","_construct","has","fn","node","return","stateNode","__objects","endsWith","attach","appendChild","parentInstance","child","isObject3D","add","attachArray","attachObject","insertBefore","beforeChild","dispatchEvent","restSiblings","children","filter","sibling","removeRecursive","array","clone","removeChild","remove","x","switchInstance","fiber","newInstance","alternate","Renderer","now","warnsIfNotActing","supportsMutation","isPrimaryRenderer","scheduleTimeout","setTimeout","cancelTimeout","clearTimeout","noTimeout","appendInitialChild","appendChildToContainer","removeChildFromContainer","insertInContainerBefore","commitUpdate","updatePayload","_newProps$args","argsNew","restNew","_excluded2","_oldProps$args","argsOld","restOld","_excluded3","hasNewArgs","some","_ref4","_ref5","val","hideInstance","visible","unhideInstance","hideTextInstance","Error","getPublicInstance","getRootHostContext","getChildHostContext","createTextInstance","finalizeInitialChildren","commitMount","prepareUpdate","shouldDeprioritizeSubtree","prepareForCommit","preparePortalMount","resetAfterCommit","shouldSetTextContent","clearContainer","hasSymbol","Symbol","for","REACT_PORTAL_TYPE","element","get","newRoot","createContainer","concurrent","updateContainer","getPublicRootInstance","unmountComponentAtNode","delete","createPortal","implementation","$$typeof","injectIntoDevTools","bundleType","process","env","NODE_ENV","findHostInstanceByFiber","rendererPackageName","threeTypes","freeze","__proto__","isOrthographicCamera","def","makeId","event","eventObject","uuid","stateContext","useCanvas","orthographic","raycaster","size","pixelRatio","_props$vr","_props$concurrent","_props$shadowMap","shadowMap","_props$colorManagemen","_props$invalidateFram","_props$updateDefaultC","updateDefaultCamera","_props$noEvents","noEvents","onCreated","onPointerMissed","_useState","_useState2","setReady","_useState3","_useState4","mouse","_useState5","ray","computeOffsets","raycasterProps","_excluded4","_useState6","defaultRaycaster","_useState7","_useState8","defaultScene","_useState9","cam","position","z","lookAt","_useState10","defaultCam","setDefaultCamera","_useState11","_useState12","aspect","viewport","initialClick","initialHits","pointer","captured","events","subscribe","priority","sort","_state$current","s","intersect","prepare","handlePointerMove","getCurrentViewport","_state$current$size","width","height","distance","getWorldPosition","distanceTo","zoom","factor","fov","PI","h","tan","w","assign","left","right","top","bottom","updateProjectionMatrix","updateMatrixWorld","setSize","sharedState","_state$current2","_excluded5","setPixelRatio","min","window","devicePixelRatio","enabled","toneMapping","outputEncoding","hovered","temp","prepareRay","offsets","nativeEvent","offsetX","offsetY","_state$current$size2","setFromCamera","seen","Set","hits","eventsObjects","intersects","intersectObjects","item","id","_iterator","_createForOfIteratorHelper","_step","n","done","err","e","f","calculateDistance","dx","dy","round","sqrt","handlePointerCancel","emit","from","values","hoveredObj","find","hit","data","intersections","pointerOut","pointerLeave","getIntersects","handleIntersects","unprojectedPoint","y","unproject","releasePointerCapture","localState","stopped","_iterator2","_step2","_loop","setPointerCapture","raycastEvent","stopPropagation","cap","higher","currentTarget","sourceEvent","pointerOver","pointerEnter","hoveredItem","pointerMove","handlePointer","pointerMissed","map","onClick","onContextMenu","onDoubleClick","onWheel","onPointerDown","onPointerUp","onPointerLeave","onPointerMove","onGotPointerCaptureLegacy","onLostPointerCapture","Canvas","activate","compile","result","then","Provider","xr","setAnimationLoop","t","console","warn","renderLists","forceContextLoss","_handlers$pointerMis","_handlers","call","p","context","useFrame","renderPriority","_useContext","unsubscribe","useThree","useUpdate","dependents","optionalRef","_useContext2","localRef","useResource","_useState13","_useState14","_","forceUpdate","buildGraph","nodes","materials","traverse","material","useGraph","loadingFn","extensions","onProgress","Proto","loader","_len","input","_key","Promise","all","res","reject","load","error","_error$message","message","useLoader","results","preload","defaultStyles","overflow","Content","_ref6","setEvents","renderer","effects","_excluded6","_useState15","_useState16","ResizeContainer","memo","webgl1","preRender","resize","style","restSpread","_excluded7","containerRef","_useState17","_useState18","_useState18$","_excluded8","_useMeasure","scroll","debounce","_useMeasure2","bind","readyFlag","_ref7","_excluded9","canvasRef","params","antialias","alpha","powerPreference","canvas","display","ReactThreeFiber"],"sources":["/Users/Aaron/Desktop/mirrorsReactThreeFiber/node_modules/react-three-fiber/web.js"],"sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as THREE from 'three';\nimport { Layers, Color, Texture, sRGBEncoding, Vector2, Raycaster, Scene, OrthographicCamera, PerspectiveCamera, Clock, Vector3, PCFSoftShadowMap, ACESFilmicToneMapping, WebGL1Renderer, WebGLRenderer } from 'three';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport React, { createContext, useState, useRef, useCallback, useMemo, useLayoutEffect, useEffect, createElement, useContext as useContext$1 } from 'react';\nimport { TinyEmitter } from 'tiny-emitter';\nimport { useAsset } from 'use-asset';\nimport useMeasure from 'react-use-measure';\nimport mergeRefs from 'react-merge-refs';\n\nvar name = \"react-three-fiber\";\nvar version = \"5.3.22\";\n\nconst roots = new Map();\nconst emptyObject = {};\nconst is = {\n  obj: a => a === Object(a) && !is.arr(a),\n  fun: a => typeof a === 'function',\n  str: a => typeof a === 'string',\n  num: a => typeof a === 'number',\n  und: a => a === void 0,\n  arr: a => Array.isArray(a),\n\n  equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    let i;\n\n    for (i in a) if (!(i in b)) return false;\n\n    for (i in b) if (a[i] !== b[i]) return false;\n\n    return is.und(i) ? a === b : true;\n  }\n\n};\n\nfunction createSubs(callback, subs) {\n  const index = subs.length;\n  subs.push(callback);\n  return () => void subs.splice(index, 1);\n}\n\nlet globalEffects = [];\nlet globalAfterEffects = [];\nlet globalTailEffects = [];\nconst addEffect = callback => createSubs(callback, globalEffects);\nconst addAfterEffect = callback => createSubs(callback, globalAfterEffects);\nconst addTail = callback => createSubs(callback, globalTailEffects);\nfunction renderGl(state, timestamp, repeat = 0, runGlobalEffects = false) {\n  let i; // Run global effects\n\n  if (runGlobalEffects) {\n    for (i = 0; i < globalEffects.length; i++) {\n      globalEffects[i](timestamp);\n      repeat++;\n    }\n  } // Run local effects\n\n\n  const delta = state.current.clock.getDelta();\n\n  for (i = 0; i < state.current.subscribers.length; i++) {\n    state.current.subscribers[i].ref.current(state.current, delta);\n  } // Decrease frame count\n\n\n  state.current.frames = Math.max(0, state.current.frames - 1);\n  repeat += !state.current.invalidateFrameloop ? 1 : state.current.frames; // Render content\n\n  if (!state.current.manual && state.current.gl.render) state.current.gl.render(state.current.scene, state.current.camera); // Run global after-effects\n\n  if (runGlobalEffects) {\n    for (i = 0; i < globalAfterEffects.length; i++) {\n      globalAfterEffects[i](timestamp);\n    }\n  }\n\n  return repeat;\n}\nlet running = false;\n\nfunction renderLoop(timestamp) {\n  running = true;\n  let repeat = 0;\n  let i; // Run global effects\n\n  for (i = 0; i < globalEffects.length; i++) {\n    globalEffects[i](timestamp);\n    repeat++;\n  }\n\n  roots.forEach(root => {\n    const state = root.containerInfo.__state; // If the frameloop is invalidated, do not run another frame\n\n    if (state.current.active && state.current.ready && (!state.current.invalidateFrameloop || state.current.frames > 0)) {\n      repeat = renderGl(state, timestamp, repeat);\n    } else {\n      repeat = 0;\n    }\n  }); // Run global after-effects\n\n  for (i = 0; i < globalAfterEffects.length; i++) {\n    globalAfterEffects[i](timestamp);\n  }\n\n  if (repeat !== 0) {\n    return requestAnimationFrame(renderLoop);\n  } else {\n    // Tail call effects, they are called when rendering stops\n    for (i = 0; i < globalTailEffects.length; i++) {\n      globalTailEffects[i](timestamp);\n    }\n  } // Flag end of operation\n\n\n  running = false;\n}\n\nfunction invalidate(state = true, frames = 1) {\n  if (state === true) {\n    roots.forEach(root => {\n      const state = root.containerInfo.__state;\n      state.current.frames = state.current.ready ? state.current.frames + frames : frames;\n    });\n  } else if (state && state.current) {\n    if (state.current.vr) return;\n    state.current.frames = state.current.ready ? state.current.frames + frames : frames;\n  }\n\n  if (!running) {\n    running = true;\n    requestAnimationFrame(renderLoop);\n  }\n}\nfunction forceResize() {\n  roots.forEach(root => root.containerInfo.__state.current.forceResize());\n}\nlet catalogue = {};\nconst extend = objects => void (catalogue = { ...catalogue,\n  ...objects\n});\nfunction applyProps(instance, newProps, oldProps = {}, accumulative = false) {\n  // Filter equals, events and reserved props\n  const container = instance.__container;\n  const sameProps = [];\n  const handlers = [];\n  let i;\n  let keys = Object.keys(newProps);\n\n  for (i = 0; i < keys.length; i++) {\n    if (is.equ(newProps[keys[i]], oldProps[keys[i]])) {\n      sameProps.push(keys[i]);\n    } // Event-handlers ...\n    //   are functions, that\n    //   start with \"on\", and\n    //   contain the name \"Pointer\", \"Click\", \"ContextMenu\", or \"Wheel\"\n\n\n    if (is.fun(newProps[keys[i]]) && keys[i].startsWith('on')) {\n      if (keys[i].includes('Pointer') || keys[i].includes('Click') || keys[i].includes('ContextMenu') || keys[i].includes('Wheel')) {\n        handlers.push(keys[i]);\n      }\n    }\n  }\n\n  const leftOvers = [];\n  keys = Object.keys(oldProps);\n\n  if (accumulative) {\n    for (i = 0; i < keys.length; i++) {\n      if (newProps[keys[i]] === void 0) {\n        leftOvers.push(keys[i]);\n      }\n    }\n  }\n\n  const toFilter = [...sameProps, 'children', 'key', 'ref']; // Instances use \"object\" as a reserved identifier\n\n  if (instance.__instance) toFilter.push('object');\n  const filteredProps = { ...newProps\n  }; // Removes sameProps and reserved props from newProps\n\n  keys = Object.keys(filteredProps);\n\n  for (i = 0; i < keys.length; i++) {\n    if (toFilter.indexOf(keys[i]) > -1) {\n      delete filteredProps[keys[i]];\n    }\n  } // Add left-overs as undefined props so they can be removed\n\n\n  keys = Object.keys(leftOvers);\n\n  for (i = 0; i < keys.length; i++) {\n    if (keys[i] !== 'children') {\n      filteredProps[keys[i]] = undefined;\n    }\n  }\n\n  const filteredPropsEntries = Object.entries(filteredProps);\n\n  if (filteredPropsEntries.length > 0) {\n    filteredPropsEntries.forEach(([key, value]) => {\n      if (!handlers.includes(key)) {\n        var _instance$__container, _instance$__container2;\n\n        let root = instance;\n        let target = root[key];\n\n        if (key.includes('-')) {\n          const entries = key.split('-');\n          target = entries.reduce((acc, key) => acc[key], instance); // If the target is atomic, it forces us to switch the root\n\n          if (!(target && target.set)) {\n            const [name, ...reverseEntries] = entries.reverse();\n            root = reverseEntries.reverse().reduce((acc, key) => acc[key], instance);\n            key = name;\n          }\n        } // Special treatment for objects with support for set/copy\n\n\n        const isColorManagement = (_instance$__container = instance.__container) == null ? void 0 : (_instance$__container2 = _instance$__container.__state) == null ? void 0 : _instance$__container2.current.colorManagement;\n\n        if (target && target.set && (target.copy || target instanceof Layers)) {\n          // If value is an array it has got to be the set function\n          if (Array.isArray(value)) {\n            target.set(...value);\n          } // Test again target.copy(class) next ...\n          else if (target.copy && value && value.constructor && target.constructor.name === value.constructor.name) {\n              target.copy(value);\n            } // If nothing else fits, just set the single value, ignore undefined\n            // https://github.com/react-spring/react-three-fiber/issues/274\n            else if (value !== undefined) {\n                target.set(value); // Auto-convert sRGB colors, for now ...\n                // https://github.com/react-spring/react-three-fiber/issues/344\n\n                if (isColorManagement && target instanceof Color) {\n                  target.convertSRGBToLinear();\n                }\n              } // Else, just overwrite the value\n\n        } else {\n          root[key] = value; // Auto-convert sRGB textures, for now ...\n          // https://github.com/react-spring/react-three-fiber/issues/344\n\n          if (isColorManagement && root[key] instanceof Texture) {\n            root[key].encoding = sRGBEncoding;\n          }\n        }\n\n        invalidateInstance(instance);\n      }\n    }); // Preemptively delete the instance from the containers interaction\n\n    if (accumulative && container && instance.raycast && instance.__handlers) {\n      instance.__handlers = undefined;\n\n      const index = container.__interaction.indexOf(instance);\n\n      if (index > -1) container.__interaction.splice(index, 1);\n    } // Prep interaction handlers\n\n\n    if (handlers.length) {\n      if (accumulative && container && instance.raycast) container.__interaction.push(instance); // Add handlers to the instances handler-map\n\n      instance.__handlers = handlers.reduce((acc, key) => {\n        acc[key.charAt(2).toLowerCase() + key.substr(3)] = newProps[key];\n        return acc;\n      }, {});\n    } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n\n    if (instance.parent) updateInstance(instance);\n  }\n}\n\nfunction invalidateInstance(instance) {\n  if (instance.__container && instance.__container.__state) invalidate(instance.__container.__state);\n}\n\nfunction updateInstance(instance) {\n  if (instance.onUpdate) instance.onUpdate(instance);\n}\n\nfunction createInstance(type, {\n  args = [],\n  ...props\n}, container, hostContext, internalInstanceHandle) {\n  let name = `${type[0].toUpperCase()}${type.slice(1)}`;\n  let instance;\n\n  if (type === 'primitive') {\n    // Switch off dispose for primitive objects\n    props = {\n      dispose: null,\n      ...props\n    };\n    instance = props.object;\n    instance.__instance = true;\n    instance.__dispose = instance.dispose;\n  } else {\n    const target = catalogue[name] || THREE[name];\n\n    if (!target) {\n      throw `\"${name}\" is not part of the THREE namespace! Did you forget to extend it? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively`;\n    }\n\n    instance = is.arr(args) ? new target(...args) : new target(args);\n  } // Bind to the root container in case portals are being used\n  // This is perhaps better for event management as we can keep them on a single instance\n\n\n  while (container.__container) {\n    container = container.__container;\n  } // TODO: https://github.com/facebook/react/issues/17147\n  // If it's still not there it means the portal was created on a virtual node outside of react\n\n\n  if (!roots.has(container)) {\n    const fn = node => {\n      if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n    };\n\n    container = fn(internalInstanceHandle);\n  } // Apply initial props\n\n\n  instance.__objects = [];\n  instance.__container = container; // Auto-attach geometries and materials\n\n  if (name.endsWith('Geometry')) {\n    props = {\n      attach: 'geometry',\n      ...props\n    };\n  } else if (name.endsWith('Material')) {\n    props = {\n      attach: 'material',\n      ...props\n    };\n  } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n  // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n  // why it passes \"true\" here\n\n\n  applyProps(instance, props, {});\n  return instance;\n}\n\nfunction appendChild(parentInstance, child) {\n  if (child) {\n    if (child.isObject3D) {\n      parentInstance.add(child);\n    } else {\n      parentInstance.__objects.push(child);\n\n      child.parent = parentInstance; // The attach attribute implies that the object attaches itself on the parent\n\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach) {\n        parentInstance[child.attach] = child;\n      }\n    }\n\n    updateInstance(child);\n    invalidateInstance(child);\n  }\n}\n\nfunction insertBefore(parentInstance, child, beforeChild) {\n  if (child) {\n    if (child.isObject3D) {\n      child.parent = parentInstance;\n      child.dispatchEvent({\n        type: 'added'\n      });\n      const restSiblings = parentInstance.children.filter(sibling => sibling !== child); // TODO: the order is out of whack if data objects are present, has to be recalculated\n\n      const index = restSiblings.indexOf(beforeChild);\n      parentInstance.children = [...restSiblings.slice(0, index), child, ...restSiblings.slice(index)];\n      updateInstance(child);\n    } else {\n      appendChild(parentInstance, child);\n    } // TODO: order!!!\n\n\n    invalidateInstance(child);\n  }\n}\n\nfunction removeRecursive(array, parent, clone = false) {\n  if (array) {\n    // Three uses splice op's internally we may have to shallow-clone the array in order to safely remove items\n    const target = clone ? [...array] : array;\n    target.forEach(child => removeChild(parent, child));\n  }\n}\n\nfunction removeChild(parentInstance, child) {\n  if (child) {\n    if (child.isObject3D) {\n      parentInstance.remove(child);\n    } else {\n      child.parent = null;\n      if (parentInstance.__objects) parentInstance.__objects = parentInstance.__objects.filter(x => x !== child); // Remove attachment\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(x => x !== child);\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach) {\n        parentInstance[child.attach] = null;\n      }\n    } // Remove interactivity\n\n\n    if (child.__container) child.__container.__interaction = child.__container.__interaction.filter(x => x !== child);\n    invalidateInstance(child); // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n\n    if (child.dispose !== null) {\n      unstable_runWithPriority(unstable_IdlePriority, () => {\n        // Remove nested child objects\n        removeRecursive(child.__objects, child);\n        removeRecursive(child.children, child, true); // Dispose item\n\n        if (child.dispose && child.type !== 'Scene') child.dispose();else if (child.__dispose) child.__dispose(); // Remove references\n\n        delete child.__container;\n        delete child.__objects;\n      });\n    }\n  }\n}\n\nfunction switchInstance(instance, type, newProps, fiber) {\n  const parent = instance.parent;\n  const newInstance = createInstance(type, newProps, instance.__container, null, fiber);\n  removeChild(parent, instance);\n  appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n  // https://github.com/facebook/react/issues/14983\n  // https://github.com/facebook/react/pull/15021\n  ;\n  [fiber, fiber.alternate].forEach(fiber => {\n    if (fiber !== null) {\n      fiber.stateNode = newInstance;\n\n      if (fiber.ref) {\n        if (is.fun(fiber.ref)) fiber.ref(newInstance);else fiber.ref.current = newInstance;\n      }\n    }\n  });\n}\n\nconst Renderer = Reconciler({\n  now: unstable_now,\n  createInstance,\n  removeChild,\n  appendChild,\n  insertBefore,\n  warnsIfNotActing: true,\n  supportsMutation: true,\n  isPrimaryRenderer: false,\n  scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n  cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n  // @ts-ignore\n  setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n  // @ts-ignore\n  clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n  noTimeout: -1,\n  appendInitialChild: appendChild,\n  appendChildToContainer: appendChild,\n  removeChildFromContainer: removeChild,\n  insertInContainerBefore: insertBefore,\n\n  commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n    if (instance.__instance && newProps.object && newProps.object !== instance) {\n      // <instance object={...} /> where the object reference has changed\n      switchInstance(instance, type, newProps, fiber);\n    } else {\n      // This is a data object, let's extract critical information about it\n      const {\n        args: argsNew = [],\n        ...restNew\n      } = newProps;\n      const {\n        args: argsOld = [],\n        ...restOld\n      } = oldProps; // If it has new props or arguments, then it needs to be re-instanciated\n\n      const hasNewArgs = argsNew.some((value, index) => is.obj(value) ? Object.entries(value).some(([key, val]) => val !== argsOld[index][key]) : value !== argsOld[index]);\n\n      if (hasNewArgs) {\n        // Next we create a new instance and append it again\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // Otherwise just overwrite props\n        applyProps(instance, restNew, restOld, true);\n      }\n    }\n  },\n\n  hideInstance(instance) {\n    if (instance.isObject3D) {\n      instance.visible = false;\n      invalidateInstance(instance);\n    }\n  },\n\n  unhideInstance(instance, props) {\n    if (instance.isObject3D && props.visible == null || props.visible) {\n      instance.visible = true;\n      invalidateInstance(instance);\n    }\n  },\n\n  hideTextInstance() {\n    throw new Error('Text is not allowed in the react-three-fiber tree. You may have extraneous whitespace between components.');\n  },\n\n  getPublicInstance(instance) {\n    return instance;\n  },\n\n  getRootHostContext() {\n    return emptyObject;\n  },\n\n  getChildHostContext() {\n    return emptyObject;\n  },\n\n  createTextInstance() {},\n\n  finalizeInitialChildren(instance) {\n    // https://github.com/facebook/react/issues/20271\n    // Returning true will trigger commitMount\n    return instance.__handlers;\n  },\n\n  commitMount(instance)\n  /*, type, props*/\n  {\n    // https://github.com/facebook/react/issues/20271\n    // This will make sure events are only added once to the central container\n    const container = instance.__container;\n    if (container && instance.raycast && instance.__handlers) container.__interaction.push(instance);\n  },\n\n  prepareUpdate() {\n    return emptyObject;\n  },\n\n  shouldDeprioritizeSubtree() {\n    return false;\n  },\n\n  prepareForCommit() {\n    return null;\n  },\n\n  preparePortalMount() {\n    return null;\n  },\n\n  resetAfterCommit() {},\n\n  shouldSetTextContent() {\n    return false;\n  },\n\n  clearContainer() {\n    return false;\n  }\n\n});\nconst hasSymbol = is.fun(Symbol) && Symbol.for;\nconst REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\nfunction render(element, container, state) {\n  let root = roots.get(container);\n\n  if (!root) {\n    container.__state = state; // @ts-ignore\n\n    let newRoot = root = Renderer.createContainer(container, state !== undefined && state.current.concurrent ? 2 : 0, false, // @ts-ignore\n    null);\n    roots.set(container, newRoot);\n  }\n\n  Renderer.updateContainer(element, root, null, () => undefined);\n  return Renderer.getPublicRootInstance(root);\n}\nfunction unmountComponentAtNode(container, callback) {\n  const root = roots.get(container);\n\n  if (root) {\n    Renderer.updateContainer(null, root, null, () => {\n      roots.delete(container);\n      if (callback) callback(container);\n    });\n  }\n}\nfunction createPortal(children, containerInfo, implementation, key = null) {\n  if (!containerInfo.__objects) containerInfo.__objects = [];\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children,\n    containerInfo,\n    implementation\n  };\n}\nRenderer.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  //@ts-ignore\n  findHostInstanceByFiber: () => null,\n  version: version,\n  rendererPackageName: name\n});\n\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\n\nfunction isOrthographicCamera(def) {\n  return def.isOrthographicCamera;\n}\n\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\n\nconst stateContext = /*#__PURE__*/createContext({});\nconst useCanvas = props => {\n  const {\n    children,\n    gl,\n    camera,\n    orthographic,\n    raycaster,\n    size,\n    pixelRatio,\n    vr = false,\n    concurrent = false,\n    shadowMap = false,\n    colorManagement = true,\n    invalidateFrameloop = false,\n    updateDefaultCamera = true,\n    noEvents = false,\n    onCreated,\n    onPointerMissed,\n    forceResize\n  } = props; // Local, reactive state\n\n  const [ready, setReady] = useState(false);\n  const [mouse] = useState(() => new Vector2());\n  const [defaultRaycaster] = useState(() => {\n    const ray = new Raycaster();\n\n    if (raycaster) {\n      const {\n        filter,\n        computeOffsets,\n        ...raycasterProps\n      } = raycaster;\n      applyProps(ray, raycasterProps, {});\n    }\n\n    return ray;\n  });\n  const [defaultScene] = useState(() => {\n    const scene = new Scene();\n    scene.__interaction = [];\n    scene.__objects = [];\n    return scene;\n  });\n  const [defaultCam, setDefaultCamera] = useState(() => {\n    const cam = orthographic ? new OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new PerspectiveCamera(75, 0, 0.1, 1000);\n    cam.position.z = 5;\n    if (camera) applyProps(cam, camera, {}); // Always look at [0, 0, 0]\n\n    cam.lookAt(0, 0, 0);\n    return cam;\n  });\n  const [clock] = useState(() => new Clock()); // Public state\n\n  const state = useRef({\n    ready: false,\n    active: true,\n    manual: 0,\n    colorManagement,\n    vr,\n    concurrent,\n    noEvents,\n    invalidateFrameloop: false,\n    frames: 0,\n    aspect: 0,\n    subscribers: [],\n    camera: defaultCam,\n    scene: defaultScene,\n    raycaster: defaultRaycaster,\n    mouse,\n    clock,\n    gl,\n    size,\n    viewport: null,\n    initialClick: [0, 0],\n    initialHits: [],\n    pointer: new TinyEmitter(),\n    captured: undefined,\n    events: undefined,\n    subscribe: (ref, priority = 0) => {\n      // If this subscription was given a priority, it takes rendering into its own hands\n      // For that reason we switch off automatic rendering and increase the manual flag\n      // As long as this flag is positive (there could be multiple render subscription)\n      // ..there can be no internal rendering at all\n      if (priority) state.current.manual++;\n      state.current.subscribers.push({\n        ref,\n        priority: priority\n      }); // Sort layers from lowest to highest, meaning, highest priority renders last (on top of the other frames)\n\n      state.current.subscribers = state.current.subscribers.sort((a, b) => a.priority - b.priority);\n      return () => {\n        var _state$current;\n\n        if ((_state$current = state.current) == null ? void 0 : _state$current.subscribers) {\n          // Decrease manual flag if this subscription had a priority\n          if (priority) state.current.manual--;\n          state.current.subscribers = state.current.subscribers.filter(s => s.ref !== ref);\n        }\n      };\n    },\n    setDefaultCamera: camera => setDefaultCamera(camera),\n    invalidate: () => invalidate(state),\n    intersect: (event = {}, prepare = true) => handlePointerMove(event, prepare),\n    forceResize\n  });\n  const position = new Vector3();\n  const getCurrentViewport = useCallback((camera = state.current.camera, target = new Vector3(0, 0, 0)) => {\n    const {\n      width,\n      height\n    } = state.current.size;\n    const distance = camera.getWorldPosition(position).distanceTo(target);\n\n    if (isOrthographicCamera(camera)) {\n      return {\n        width: width / camera.zoom,\n        height: height / camera.zoom,\n        factor: 1,\n        distance\n      };\n    } else {\n      const fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n      const h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n      const w = h * (width / height);\n      return {\n        width: w,\n        height: h,\n        factor: width / w,\n        distance\n      };\n    }\n  }, []); // Writes locals into public state for distribution among subscribers, context, etc\n\n  useMemo(() => {\n    state.current.ready = ready;\n    state.current.size = size;\n    state.current.camera = defaultCam;\n    state.current.invalidateFrameloop = invalidateFrameloop;\n    state.current.vr = vr;\n    state.current.gl = gl;\n    state.current.concurrent = concurrent;\n    state.current.noEvents = noEvents; // Make viewport backwards compatible\n\n    state.current.viewport = getCurrentViewport; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [invalidateFrameloop, vr, concurrent, noEvents, ready, size, defaultCam, gl]); // Adjusts default camera\n\n  useMemo(() => {\n    state.current.aspect = size.width / size.height; // Assign viewport props to the function\n\n    Object.assign(state.current.viewport, getCurrentViewport()); // https://github.com/drcmda/react-three-fiber/issues/92\n    // Sometimes automatic default camera adjustment isn't wanted behaviour\n\n    if (updateDefaultCamera) {\n      if (isOrthographicCamera(defaultCam)) {\n        defaultCam.left = size.width / -2;\n        defaultCam.right = size.width / 2;\n        defaultCam.top = size.height / 2;\n        defaultCam.bottom = size.height / -2;\n      } else {\n        defaultCam.aspect = state.current.aspect;\n      }\n\n      defaultCam.updateProjectionMatrix(); // https://github.com/react-spring/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      defaultCam.updateMatrixWorld();\n    }\n\n    gl.setSize(size.width, size.height);\n    if (ready) invalidate(state); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultCam, gl, size, updateDefaultCamera, ready]); // Only trigger the context provider when necessary\n\n  const sharedState = useRef(null);\n  useMemo(() => {\n    const {\n      ready,\n      manual,\n      vr,\n      noEvents,\n      invalidateFrameloop,\n      frames,\n      subscribers,\n      captured,\n      initialClick,\n      initialHits,\n      ...props\n    } = state.current;\n    sharedState.current = props; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [size, defaultCam]); // Update pixel ratio\n\n  useLayoutEffect(() => {\n    if (pixelRatio) {\n      if (Array.isArray(pixelRatio)) gl.setPixelRatio(Math.max(Math.min(pixelRatio[0], window.devicePixelRatio), pixelRatio[1]));else gl.setPixelRatio(pixelRatio);\n    }\n  }, [gl, pixelRatio]); // Update shadow map\n\n  useLayoutEffect(() => {\n    if (shadowMap) {\n      gl.shadowMap.enabled = true;\n      if (typeof shadowMap === 'object') Object.assign(gl.shadowMap, shadowMap);else gl.shadowMap.type = PCFSoftShadowMap;\n    }\n\n    if (colorManagement) {\n      gl.toneMapping = ACESFilmicToneMapping;\n      gl.outputEncoding = sRGBEncoding;\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [shadowMap, colorManagement]);\n  /** Events ------------------------------------------------------------------------------------------------ */\n\n  const hovered = useMemo(() => new Map(), []);\n  const temp = new Vector3();\n  /** Sets up defaultRaycaster */\n\n  const prepareRay = useCallback(event => {\n    // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n    const offsets = (raycaster == null ? void 0 : raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, sharedState.current)) || event.nativeEvent;\n\n    if (offsets) {\n      const {\n        offsetX,\n        offsetY\n      } = offsets;\n      const {\n        width,\n        height\n      } = state.current.size;\n      mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n      defaultRaycaster.setFromCamera(mouse, state.current.camera);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n  /** Intersects interaction objects using the event input */\n\n  const intersect = useCallback(filter => {\n    // Skip event handling when noEvents is set\n    if (state.current.noEvents) return [];\n    const seen = new Set();\n    const hits = []; // Allow callers to eliminate event objects\n\n    const eventsObjects = filter ? filter(state.current.scene.__interaction) : state.current.scene.__interaction; // Intersect known handler objects and filter against duplicates\n\n    let intersects = defaultRaycaster.intersectObjects(eventsObjects, true).filter(item => {\n      const id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster && raycaster.filter && sharedState.current) {\n      intersects = raycaster.filter(intersects, sharedState.current);\n    }\n\n    for (const intersect of intersects) {\n      let eventObject = intersect.object; // Bubble event up\n\n      while (eventObject) {\n        const handlers = eventObject.__handlers;\n        if (handlers) hits.push({ ...intersect,\n          eventObject\n        });\n        eventObject = eventObject.parent;\n      }\n    }\n\n    return hits;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  /**  Calculates click deltas */\n\n  const calculateDistance = useCallback(event => {\n    const dx = event.nativeEvent.offsetX - state.current.initialClick[0];\n    const dy = event.nativeEvent.offsetY - state.current.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }, []);\n  const handlePointerCancel = useCallback((event, hits, prepare = true) => {\n    state.current.pointer.emit('pointerCancel', event);\n    if (prepare) prepareRay(event);\n    Array.from(hovered.values()).forEach(hoveredObj => {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (hits && (!hits.length || !hits.find(hit => hit.object === hoveredObj.object && hit.index === hoveredObj.index))) {\n        const eventObject = hoveredObj.eventObject;\n        const handlers = eventObject.__handlers;\n        hovered.delete(makeId(hoveredObj));\n\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          const data = { ...hoveredObj,\n            intersections: hits || []\n          };\n          if (handlers.pointerOut) handlers.pointerOut({ ...data,\n            type: 'pointerout'\n          });\n          if (handlers.pointerLeave) handlers.pointerLeave({ ...data,\n            type: 'pointerleave'\n          });\n        }\n      }\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n  const getIntersects = useCallback((event, filter) => {\n    // Get fresh intersects\n    const intersections = intersect(filter); // If the interaction is captured take that into account, the captured event has to be part of the intersects\n\n    if (state.current.captured && event.type && event.type !== 'click' && event.type !== 'wheel') {\n      state.current.captured.forEach(captured => {\n        if (!intersections.find(hit => hit.eventObject === captured.eventObject)) intersections.push(captured);\n      });\n    }\n\n    return intersections;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  /**  Handles intersections by forwarding them to handlers */\n\n  const handleIntersects = useCallback((intersections, event, fn) => {\n    // If anything has been found, forward it to the event listeners\n    if (intersections.length) {\n      const unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(state.current.camera);\n      const delta = event.type === 'click' ? calculateDistance(event) : 0;\n\n      const releasePointerCapture = id => event.target.releasePointerCapture(id);\n\n      const localState = {\n        stopped: false,\n        captured: false\n      };\n\n      for (const hit of intersections) {\n        const setPointerCapture = id => {\n          // If the hit is going to be captured flag that we're in captured state\n          if (!localState.captured) {\n            localState.captured = true; // The captured hit array is reset to collect hits\n\n            state.current.captured = [];\n          } // Push hits to the array\n\n\n          if (state.current.captured) {\n            state.current.captured.push(hit);\n          } // Call the original event now\n          event.target.setPointerCapture(id);\n        };\n\n        const raycastEvent = { ...event,\n          ...hit,\n          intersections,\n          stopped: localState.stopped,\n          delta,\n          unprojectedPoint,\n          ray: defaultRaycaster.ray,\n          camera: state.current.camera,\n          // Hijack stopPropagation, which just sets a flag\n          stopPropagation: () => {\n            // https://github.com/react-spring/react-three-fiber/issues/596\n            // Events are not allowed to stop propagation if the pointer has been captured\n            const cap = state.current.captured;\n\n            if (!cap || cap.find(h => h.eventObject.id === hit.eventObject.id)) {\n              raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n              // An event handler is only allowed to flush other handlers if it is hovered itself\n\n              if (hovered.size && Array.from(hovered.values()).find(i => i.eventObject === hit.eventObject)) {\n                // Objects cannot flush out higher up objects that have already caught the event\n                const higher = intersections.slice(0, intersections.indexOf(hit));\n                handlePointerCancel(raycastEvent, [...higher, hit]);\n              }\n            }\n          },\n          target: { ...event.target,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          currentTarget: { ...event.currentTarget,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          sourceEvent: event\n        };\n        fn(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n        if (localState.stopped === true) break;\n      }\n    }\n\n    return intersections;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  const handlePointerMove = useCallback((event, prepare = true) => {\n    state.current.pointer.emit('pointerMove', event);\n    if (prepare) prepareRay(event);\n    const hits = getIntersects(event, // This is onPointerMove, we're only interested in events that exhibit this particular event\n    objects => objects.filter(obj => ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(name => obj.__handlers['pointer' + name]))); // Take care of unhover\n\n    handlePointerCancel(event, hits);\n    handleIntersects(hits, event, data => {\n      const eventObject = data.eventObject;\n      const handlers = eventObject.__handlers; // Check presence of handlers\n\n      if (!handlers) return; // Check if mouse enter or out is present\n\n      if (handlers.pointerOver || handlers.pointerEnter || handlers.pointerOut || handlers.pointerLeave) {\n        const id = makeId(data);\n        const hoveredItem = hovered.get(id);\n\n        if (!hoveredItem) {\n          // If the object wasn't previously hovered, book it and call its handler\n          hovered.set(id, data);\n          if (handlers.pointerOver) handlers.pointerOver({ ...data,\n            type: 'pointerover'\n          });\n          if (handlers.pointerEnter) handlers.pointerEnter({ ...data,\n            type: 'pointerenter'\n          });\n        } else if (hoveredItem.stopped) {\n          // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n          data.stopPropagation();\n        }\n      } // Call mouse move\n\n\n      if (handlers.pointerMove) handlers.pointerMove(data);\n    });\n    return hits; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const handlePointer = useCallback(name => (event, prepare = true) => {\n    state.current.pointer.emit(name, event);\n    if (prepare) prepareRay(event);\n    const hits = getIntersects(event);\n    handleIntersects(hits, event, data => {\n      const eventObject = data.eventObject;\n      const handlers = eventObject.__handlers;\n\n      if (handlers && handlers[name]) {\n        // Forward all events back to their respective handlers with the exception of click events,\n        // which must use the initial target\n        if (name !== 'click' && name !== 'contextMenu' && name !== 'doubleClick' || state.current.initialHits.includes(eventObject)) {\n          handlers[name](data);\n          pointerMissed(event, defaultScene.__interaction, object => object !== eventObject);\n        }\n      }\n    }); // If a click yields no results, pass it back to the user as a miss\n\n    if (name === 'pointerDown') {\n      state.current.initialClick = [event.nativeEvent.offsetX, event.nativeEvent.offsetY];\n      state.current.initialHits = hits.map(hit => hit.eventObject);\n    }\n\n    if ((name === 'click' || name === 'contextMenu' || name === 'doubleClick') && !hits.length) {\n      if (calculateDistance(event) <= 2) {\n        pointerMissed(event, defaultScene.__interaction);\n        if (onPointerMissed) onPointerMissed();\n      }\n    }\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [onPointerMissed, calculateDistance, getIntersects, handleIntersects, prepareRay]);\n  useMemo(() => {\n    state.current.events = {\n      onClick: handlePointer('click'),\n      onContextMenu: handlePointer('contextMenu'),\n      onDoubleClick: handlePointer('doubleClick'),\n      onWheel: handlePointer('wheel'),\n      onPointerDown: handlePointer('pointerDown'),\n      onPointerUp: handlePointer('pointerUp'),\n      onPointerLeave: e => handlePointerCancel(e, []),\n      onPointerMove: handlePointerMove,\n      // onGotPointerCapture is not needed any longer because the behaviour is hacked into\n      // the event itself (see handleIntersects). But in order for non-web targets to simulate\n      // it we keep the legacy event, which simply flags all current intersects as captured\n      onGotPointerCaptureLegacy: e => state.current.captured = intersect(),\n      onLostPointerCapture: e => (state.current.captured = undefined, handlePointerCancel(e))\n    };\n  }, [handlePointer, intersect, handlePointerCancel, handlePointerMove]);\n  /** Events ------------------------------------------------------------------------------------------------- */\n  // This component is a bridge into the three render context, when it gets rendered\n  // we know we are ready to compile shaders, call subscribers, etc\n\n  const Canvas = useCallback(function Canvas(props) {\n    const activate = () => setReady(true); // Pre-compile all materials before rendering out the first time\n\n\n    useLayoutEffect(() => void gl.compile(defaultScene, defaultCam), []);\n    useEffect(() => {\n      const result = onCreated && onCreated(state.current);\n      if (result && result.then) result.then(activate);else activate();\n    }, []);\n    return props.children;\n  }, // The Canvas component has to be static, it should not be re-created ever\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []); // Render v-dom into scene\n\n  useLayoutEffect(() => {\n    render( /*#__PURE__*/createElement(Canvas, null, /*#__PURE__*/createElement(stateContext.Provider, {\n      value: sharedState.current\n    }, typeof children === 'function' ? children(state.current) : children)), defaultScene, state); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ready, children, sharedState.current]);\n  useLayoutEffect(() => {\n    if (ready) {\n      // Start render-loop, either via RAF or setAnimationLoop for VR\n      if (!state.current.vr) {\n        if (state.current.frames === 0) invalidate(state);\n      } else if ((gl.xr || gl.vr) && gl.setAnimationLoop) {\n        (gl.xr || gl.vr).enabled = true;\n        gl.setAnimationLoop(t => renderGl(state, t, 0, true));\n      } else {\n        console.warn('the gl instance does not support VR!');\n      }\n    }\n  }, [gl, ready, invalidateFrameloop]); // Dispose renderer on unmount\n\n  useEffect(() => () => {\n    if (state.current.gl) {\n      if (state.current.gl.renderLists) state.current.gl.renderLists.dispose();\n      if (state.current.gl.forceContextLoss) state.current.gl.forceContextLoss();\n      dispose(state.current.gl);\n    }\n\n    unmountComponentAtNode(state.current.scene, () => {\n      dispose(state.current.raycaster);\n      dispose(state.current.camera);\n      dispose(state.current);\n    });\n  }, []);\n  return state.current.events;\n};\n\nfunction pointerMissed(event, objects, filter = object => true) {\n  objects.filter(filter).forEach(object => {\n    var _handlers$pointerMis, _handlers;\n\n    return (_handlers$pointerMis = (_handlers = object.__handlers).pointerMissed) == null ? void 0 : _handlers$pointerMis.call(_handlers, event);\n  });\n}\n\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n\n  for (const p in obj) {\n    if (typeof p === 'object' && p.dispose) p.dispose();\n    delete obj[p];\n  }\n}\n\nfunction useContext(context) {\n  let result = useContext$1(context);\n\n  if (!('subscribe' in result)) {\n    throw new Error(` react-three-fiber hooks can only be used within the Canvas component! https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#hooks`);\n  }\n\n  return result;\n}\n\nfunction useFrame(callback, renderPriority = 0) {\n  const {\n    subscribe\n  } = useContext(stateContext); // Update ref\n\n  const ref = useRef(callback);\n  useLayoutEffect(() => void (ref.current = callback), [callback]); // Subscribe/unsub\n\n  useEffect(() => {\n    const unsubscribe = subscribe(ref, renderPriority);\n    return () => unsubscribe();\n  }, [renderPriority, subscribe]);\n  return null;\n}\nfunction useThree() {\n  return useContext(stateContext);\n}\nfunction useUpdate(callback, dependents, optionalRef) {\n  const {\n    invalidate\n  } = useContext(stateContext);\n  const localRef = useRef();\n  const ref = optionalRef ? optionalRef : localRef;\n  useLayoutEffect(() => {\n    if (ref.current) {\n      callback(ref.current);\n      invalidate();\n    }\n  }, dependents); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return ref;\n}\nfunction useResource(optionalRef) {\n  const [_, forceUpdate] = useState(false);\n  const localRef = useRef(undefined);\n  const ref = optionalRef ? optionalRef : localRef;\n  useLayoutEffect(() => void forceUpdate(i => !i), []);\n  return ref;\n}\n\nfunction buildGraph(object) {\n  const data = {\n    nodes: {},\n    materials: {}\n  };\n\n  if (object) {\n    object.traverse(obj => {\n      if (obj.name) data.nodes[obj.name] = obj;\n      if (obj.material && !data.materials[obj.material.name]) data.materials[obj.material.name] = obj.material;\n    });\n  }\n\n  return data;\n}\n\nfunction useGraph(object) {\n  return useMemo(() => buildGraph(object), [object]);\n}\n\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto, ...input) {\n    // Construct new loader and run extensions\n    const loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n\n    return Promise.all(input.map(input => new Promise((res, reject) => loader.load(input, data => {\n      if (data.scene) Object.assign(data, buildGraph(data.scene));\n      res(data);\n    }, onProgress, error => {\n      var _error$message;\n\n      return reject((_error$message = error.message) != null ? _error$message : `failure loading ${input}`);\n    }))));\n  };\n}\n\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  const keys = Array.isArray(input) ? input : [input];\n  const results = useAsset(loadingFn(extensions, onProgress), Proto, ...keys); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\n\nuseLoader.preload = function (Proto, input, extensions) {\n  const keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload(loadingFn(extensions), Proto, ...keys);\n};\n\nconst defaultStyles = {\n  position: 'relative',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\n\nfunction Content({\n  children,\n  setEvents,\n  container,\n  renderer,\n  effects,\n  ...props\n}) {\n  // Create renderer\n  const [gl] = useState(renderer);\n  if (!gl) console.warn('No renderer created!'); // Mount and unmount management\n\n  useEffect(() => {\n    if (effects) effects(gl, container);\n  }, [container, effects, gl]); // Init canvas, fetch events, hand them back to the wrapping div\n\n  const events = useCanvas({ ...props,\n    children,\n    gl: gl\n  });\n  useEffect(() => {\n    setEvents(events);\n  }, [events, setEvents]);\n  return null;\n}\n\nconst ResizeContainer = /*#__PURE__*/React.memo(function ResizeContainer(props) {\n  const {\n    renderer,\n    effects,\n    children,\n    vr,\n    webgl1,\n    concurrent,\n    shadowMap,\n    colorManagement,\n    orthographic,\n    invalidateFrameloop,\n    updateDefaultCamera,\n    noEvents,\n    gl,\n    camera,\n    raycaster,\n    pixelRatio,\n    onCreated,\n    onPointerMissed,\n    preRender,\n    resize,\n    style,\n    ...restSpread\n  } = props;\n  const containerRef = useRef(); // onGotPointerCaptureLegacy is a fake event used by non-web targets to simulate poinzter capture\n\n  const [{\n    onGotPointerCaptureLegacy,\n    ...events\n  }, setEvents] = useState({});\n  const [bind, size, forceResize] = useMeasure({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    },\n    ...resize\n  }); // Flag view ready once it's been measured out\n\n  const readyFlag = useRef(false);\n  const ready = useMemo(() => readyFlag.current = readyFlag.current || !!size.width && !!size.height, [size]);\n  const state = useMemo(() => ({\n    size,\n    forceResize,\n    setEvents,\n    container: containerRef.current\n  }), [forceResize, size]); // Allow Gatsby, Next and other server side apps to run. Will output styles to reduce flickering.\n\n  if (typeof window === 'undefined') return /*#__PURE__*/React.createElement(\"div\", _extends({\n    style: { ...defaultStyles,\n      ...style\n    }\n  }, restSpread), preRender); // Render the canvas into the dom\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: mergeRefs([bind, containerRef]),\n    style: { ...defaultStyles,\n      ...style\n    }\n  }, events, restSpread), preRender, ready && /*#__PURE__*/React.createElement(Content, _extends({}, props, state)));\n});\n\nconst Canvas = /*#__PURE__*/React.memo(function Canvas({\n  children,\n  ...props\n}) {\n  const canvasRef = useRef();\n  const renderer = props.webgl1 ? WebGL1Renderer : WebGLRenderer;\n  return /*#__PURE__*/React.createElement(ResizeContainer, _extends({}, props, {\n    renderer: () => {\n      if (canvasRef.current) {\n        const params = {\n          antialias: true,\n          alpha: true,\n          ...props.gl\n        };\n        const temp = new renderer({\n          powerPreference: 'high-performance',\n          //stencil: false,\n          //depth: false,\n          canvas: canvasRef.current,\n          ...params\n        });\n        return temp;\n      }\n    },\n    preRender: /*#__PURE__*/React.createElement(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        display: 'block'\n      }\n    })\n  }), children);\n});\n\nexport { Canvas, threeTypes as ReactThreeFiber, Renderer, ResizeContainer, addAfterEffect, addEffect, addTail, applyProps, createPortal, extend, forceResize, invalidate, isOrthographicCamera, render, renderGl, stateContext, unmountComponentAtNode, useCanvas, useFrame, useGraph, useLoader, useResource, useThree, useUpdate };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}