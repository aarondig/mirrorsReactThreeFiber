'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var reactThreeFiber = require('react-three-fiber');

function Preload(_ref) {
  var all = _ref.all,
      scene = _ref.scene,
      camera = _ref.camera;

  var _useThree = reactThreeFiber.useThree(),
      gl = _useThree.gl,
      dScene = _useThree.scene,
      dCamera = _useThree.camera; // Layout effect because it must run before React commits


  React.useLayoutEffect(function () {
    var invisible = [];

    if (all) {
      (scene || dScene).traverse(function (object) {
        if (object.visible === false) {
          invisible.push(object);
          object.visible = true;
        }
      });
    } // Now compile the scene


    gl.compile(scene || dScene, camera || dCamera); // Flips these objects back

    invisible.forEach(function (object) {
      return object.visible = false;
    });
  }, []);
  return null;
}

exports.Preload = Preload;
